---
title: >-
  [백준/코틀린] 11660번: 구간 합 구하기 5
difficulty: 실버 1
categories: [백준, CLASS 4]
tags: [Kotlin, 다이나믹 프로그래밍, 누적 합]
math: true
description: 2차원 누적 합(prefix sum) 테이블을 만들어 구간 합을 각각 O(1)에 계산하는 Kotlin 누적 합 문제입니다.
---

## 링크
[11660번: 구간 합 구하기 5](https://www.acmicpc.net/problem/11660)

## 풀이
테이블의 모든 위치까지의 누적 합을 미리 계산해\
<span class="txt_bg">2차원 누적 합(`prefix sum`)</span> 테이블을 만들어두면,\
<span class="txt_bg">구간 `[(y1, x1) ~ (y2, x2)]`의 합을 `O(1)`에 구할 수 있습니다.</span>

## 2차원 누적 합 테이블

<span class="right">
![summed-area table](../assets/11660/summed%20area%20table.png){: .w="240" }
_출처: <a href="https://en.wikipedia.org/wiki/Summed-area_table">Wikipedia: Summed-area table</a>_
</span>

### 생성

누적 합 테이블을 생성할 때,\
`(i, j)`위치의 누적 합 `prefixSum[i][j]`은 다음과 같이 계산됩니다.
- `nums[i][j]`: 해당 위치의 값
- `prefixSum[i - 1][j]`: 위쪽 영역의 누적 합
- `prefixSum[i][j - 1]`: 왼쪽 영역의 누적 합
- `prefixSum[i - 1][j - 1]`: 겹치는 부분(왼쪽 위)의 누적 합

$$
\begin{aligned}
\text{prefixSum}[i][j]
&= \text{nums}[i][j] \\
&+ \text{prefixSum}[i-1][j] \\
&+ \text{prefixSum}[i][j-1] \\
&- \text{prefixSum}[i-1][j-1]
\end{aligned}
$$

<br>

### 계산
예를 들어, 위와 같이 누적 합 테이블을 미리 계산해 두었다면,\
구간 `[(4, 3) ~ (5, 5)]`의 합은 다음처럼 구할 수 있습니다.
- `prefixSum[3][2]`: 겹치는 영역 = <span style="background-color: #FFCCCC; border-radius: 6px; font-weight: 500; font-size: .85rem; padding: 3px 5px; color: #000000;">28</span>
- `prefixSum[5][5]`: 전체 영역 = <span style="background-color: #FFFF00; border-radius: 6px; font-weight: 500; font-size: .85rem; padding: 3px 5px; color: #000000;">110</span>
- `prefixSum[3][5]`: 위쪽 제외 = <span style="background-color: #33FF00; border-radius: 6px; font-weight: 500; font-size: .85rem; padding: 3px 5px; color: #000000;">65</span>
- `prefixSum[5][2]`: 왼쪽 제외 = <span style="background-color: #99CCFF; border-radius: 6px; font-weight: 500; font-size: .85rem; padding: 3px 5px; color: #000000;">46</span>

$$
\begin{aligned}
\text{sum}[(4,3),(5,5)]
&= \text{prefixSum}[3][2] \\
&+ \text{prefixSum}[5][5] \\
&- \text{prefixSum}[3][5] \\
&- \text{prefixSum}[5][2] \\
&= 27
\end{aligned}
$$

## 코드
```kotlin
fun main() {
    val (n, m) = readln().split(" ").map { it.toInt() }
    val nums = List(n) { readln().split(" ").map { it.toInt() } }
    val prefixSum = Array(n + 1) { IntArray(n + 1) }

    for (i in 1..n) {
        for (j in 1..n) {
            prefixSum[i][j] = nums[i - 1][j - 1] + prefixSum[i - 1][j] + prefixSum[i][j - 1] - prefixSum[i - 1][j - 1]
        }
    }

    repeat(m) {
        val (x1, y1, x2, y2) = readln().split(" ").map { it.toInt() }

        println(prefixSum[x2][y2] - prefixSum[x2][y1 - 1] - prefixSum[x1 - 1][y2] + prefixSum[x1 - 1][y1 - 1])
    }
}

```

## 연관 문제
- [[백준/코틀린] 11659번: 구간 합 구하기 4](https://potato-cuisine.dev/posts/BOJ-11659) - 1차원 누적합
